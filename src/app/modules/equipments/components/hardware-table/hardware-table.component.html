<div class="hardware-table-container">
  <!-- Loading state -->
  <div *ngIf="loading" class="loading-container">
    <p-progressSpinner></p-progressSpinner>
    <p>Loading hardware equipment...</p>
  </div>

  <!-- Error state -->
  <div *ngIf="error && !loading" class="error-container">
    <p-message severity="error" [text]="error"></p-message>
    <button
      pButton
      type="button"
      label="Retry"
      icon="pi pi-refresh"
      class="p-button-secondary"
      (click)="loadHardware()"
    ></button>
  </div>

  <!-- Hardware table -->
  <div *ngIf="!loading && !error" class="table-container">
    <!-- Clear Header Section -->
    <div class="table-main-header">
      <div class="header-content">
        <div class="header-left">
          <h2 class="table-title">
            <i class="pi pi-desktop"></i>
            Hardware Equipment Management
          </h2>
          <p class="table-description">
            Manage and view all hardware equipment, devices, and physical assets
            in the system
          </p>
          <div class="table-stats">
            <span class="stat-item">
              <i class="pi pi-database"></i>
              Total Items: <strong>{{ hardwareList.length }}</strong>
            </span>
          </div>
        </div>
        <div class="header-right">
          <button
            pButton
            type="button"
            label="Refresh Data"
            icon="pi pi-refresh"
            class="p-button-secondary p-button-outlined refresh-btn"
            (click)="refresh()"
          ></button>
        </div>
      </div>
    </div>

    <div class="table-actions">
      <button
        pButton
        type="button"
        label="Refresh"
        icon="pi pi-refresh"
        class="p-button-secondary p-button-outlined"
        (click)="refresh()"
      ></button>
    </div>

    <!-- Empty state -->
    <div *ngIf="hardwareList.length === 0" class="empty-state">
      <div class="empty-content">
        <i class="pi pi-desktop empty-icon"></i>
        <h3>No Hardware Equipment Found</h3>
        <p>There are no hardware items to display.</p>
      </div>
    </div>

    <!-- Data table -->
    <p-table
      #dt
      *ngIf="hardwareList.length > 0"
      [value]="hardwareList"
      [paginator]="true"
      [rows]="10"
      [rowsPerPageOptions]="[5, 10, 20, 50]"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} hardware items"
      [globalFilterFields]="[
        'hardware_name',
        'brand_name',
        'model',
        'serial_number',
        'laboratory_name',
        'campus'
      ]"
      styleClass="p-datatable-gridlines"
      [scrollable]="true"
      scrollHeight="500px"
    >
      <ng-template pTemplate="caption">
        <div class="table-header">
          <span class="table-title">
            <i class="pi pi-desktop"></i>
            Hardware Equipment ({{ hardwareList.length }} items)
          </span>
          <span class="p-input-icon-left">
            <i class="pi pi-search"></i>
            <input
              pInputText
              type="text"
              placeholder="Search hardware..."
              #searchInput
              (input)="dt.filterGlobal(searchInput.value, 'contains')"
            />
          </span>
        </div>
      </ng-template>

      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="hardware_name">
            Name <p-sortIcon field="hardware_name"></p-sortIcon>
          </th>
          <th pSortableColumn="brand_name">
            Brand <p-sortIcon field="brand_name"></p-sortIcon>
          </th>
          <th pSortableColumn="model">
            Model <p-sortIcon field="model"></p-sortIcon>
          </th>
          <th pSortableColumn="serial_number">
            Serial Number <p-sortIcon field="serial_number"></p-sortIcon>
          </th>
          <th pSortableColumn="color">
            Color <p-sortIcon field="color"></p-sortIcon>
          </th>
          <th>Dimensions</th>
          <th pSortableColumn="weight">
            Weight <p-sortIcon field="weight"></p-sortIcon>
          </th>
          <th pSortableColumn="date_acquired">
            Date Acquired <p-sortIcon field="date_acquired"></p-sortIcon>
          </th>
          <th pSortableColumn="unit_cost">
            Unit Cost <p-sortIcon field="unit_cost"></p-sortIcon>
          </th>
          <th pSortableColumn="laboratory_name">
            Laboratory <p-sortIcon field="laboratory_name"></p-sortIcon>
          </th>
          <th pSortableColumn="campus">
            Campus <p-sortIcon field="campus"></p-sortIcon>
          </th>
          <th>Actions</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-hardware let-rowIndex="rowIndex">
        <tr>
          <td>
            <div class="hardware-name">
              <strong>{{ hardware.hardware_name || "-" }}</strong>
            </div>
          </td>
          <td>{{ hardware.brand_name || "-" }}</td>
          <td>{{ hardware.model || "-" }}</td>
          <td>
            <span class="serial-number">{{
              hardware.serial_number || "-"
            }}</span>
          </td>
          <td>
            <span
              *ngIf="hardware.color"
              class="color-badge"
              [style.background-color]="hardware.color"
              [pTooltip]="hardware.color"
            >
              {{ hardware.color }}
            </span>
            <span *ngIf="!hardware.color">-</span>
          </td>
          <td>
            <span class="dimensions">{{ formatDimensions(hardware) }}</span>
          </td>
          <td>
            <span *ngIf="hardware.weight">{{ hardware.weight }} kg</span>
            <span *ngIf="!hardware.weight">-</span>
          </td>
          <td>{{ formatDate(hardware.date_acquired) }}</td>
          <td>{{ formatCurrency(hardware.unit_cost) }}</td>
          <td>{{ hardware.laboratory_name || "-" }}</td>
          <td>{{ hardware.campus || "-" }}</td>
          <td>
            <div class="action-buttons">
              <button
                pButton
                type="button"
                icon="pi pi-eye"
                class="p-button-info p-button-sm p-button-outlined"
                pTooltip="View Details"
                (click)="onView(hardware)"
              ></button>
              <button
                pButton
                type="button"
                icon="pi pi-pencil"
                class="p-button-warning p-button-sm p-button-outlined"
                pTooltip="Edit Hardware"
                (click)="onEdit(hardware)"
              ></button>
              <button
                pButton
                type="button"
                icon="pi pi-trash"
                class="p-button-danger p-button-sm p-button-outlined"
                pTooltip="Delete Hardware"
                (click)="onDelete(hardware)"
              ></button>
            </div>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="12" class="text-center">
            <div class="empty-state">
              <i class="pi pi-desktop empty-icon"></i>
              <h3>No Hardware Found</h3>
              <p>No hardware matches your search criteria.</p>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<!-- Confirmation Dialog -->
<p-confirmDialog></p-confirmDialog>

<!-- Toast Messages -->
<p-toast></p-toast>
